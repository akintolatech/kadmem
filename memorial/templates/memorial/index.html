{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kardiverse Memorial</title>
    <link type="text/css" href="{% static 'styles/style.css' %}" rel="stylesheet" />
    <link type="x-icon" href="{% static 'img/cross.webp' %}" rel="icon" />
</head>
<body>
  <div class="top-bar">
    <a href="{% url 'memorial:create_memorial' %}">
        <button class="btn btn-yellow">+ Create Memorial</button>
    </a>
    <div>
      <div class="dropdown" id="dropdown"> 
        <button class="btn btn-outline-purple" onclick="toggleDropdown()">Default â–¼</button>
        <div class="dropdown-content">
          <div onclick="openView('beamer')">
            <div class="title">ðŸ“½ Beamer Mode</div>
            <div class="subtitle">Projector presentation view</div>
          </div>

           <div onclick="openView('ar')">
            <div class="title">ðŸ“· AR Experience</div>
            <div class="subtitle">Augmented reality memorial viewing</div>
          </div>

          <div onclick="openView('vr')">
            <div class="title">ðŸŽ§ VR Memorial Garden</div>
            <div class="subtitle">Sacred VR experience with memory orbs</div>
          </div>
          
          <div onclick="openView('hologram')">
            <div class="title">âœ¨ Hologram View</div>
            <div class="subtitle">Interactive holographic experience</div>
          </div>
          <div onclick="openView('nft')">
            <div class="title">ðŸ’Ž NFT Token</div>
            <div class="subtitle">View memorial as NFT</div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="spacer-x"></div>

  <main>
    {% for memorial in memorials %}
    <div class="card-container" data-id="{{ memorial.id }}" onclick="selectCard(this)">
      <div class="card">

        <h2>GATE OF MEMORY</h2>
        
        <img src="{% if memorial.photo %} {{ memorial.photo.url }} {% else %}{% static 'img/user.jpg' %}{%  endif %}" alt="Memorial Photo" class="photo">
        
        
        <p class="name">In Loving Memory</p>
        <p class="highlight">{{ memorial.name }}</p>
        <p style="font-size: 12px; color: #555;">Scan QR code with your camera to view hologram</p>
        <img src="{% if memorial.qr_code_data %} {{ memorial.qr_code_data.url }} {% else %}{% static 'img/user.jpg' %}{%  endif %}" alt="QR Code" class="qr">
      </div>
      <div class="actions">
        <button class="secondary-button"><span><img src="{% static 'img/icons/share.svg' %}"/></span>Share</button>
        <button class="secondary-button"><span><img src="{% static 'img/icons/print.svg' %}"/></span>Print</button>
      </div>
    </div>
    {% empty %}
    <center>
    <h2>There are no memorials here </h2>
    <a href="{% url 'memorial:create_memorial' %}">
        <button class="btn btn-yellow">+ Create Memorial</button>
    </a>
    </center>
    {% endfor %}
  </main>
  
  

  <script>
    function toggleDropdown() {
      document.getElementById("dropdown").classList.toggle("show");
    }

    // Close dropdown when clicking outside
    window.onclick = function(event) {
      if (!event.target.matches('.btn-outline-purple')) {
        var dropdowns = document.getElementsByClassName("dropdown");
        for (let i = 0; i < dropdowns.length; i++) {
          dropdowns[i].classList.remove('show');
        }
      }
    }
  </script>

  <script>

    // document.querySelectorAll('.view-link').forEach(link => {
    //   link.addEventListener("click", function(e) {
    //     if (!selectedMemorialId) {
    //       e.preventDefault();
    //       alert("Please select a memorial first.");
    //     }
    //   });
    // });



    let selectedMemorialId = null;

    function selectCard(element) {
      // Remove selection from all cards
      document.querySelectorAll('.card-container').forEach(card => {
        card.classList.remove('selected');
      });

      // Highlight clicked card
      element.classList.add('selected');

      // Store the selected ID
      selectedMemorialId = element.getAttribute("data-id");
    }



    // Pass ID and and open 
    function openView(mode) { 
      if (!selectedMemorialId) { 
        alert("Please select a memorial card first."); 
        return;
      }

      const url = `/view_${mode}_memorial/${selectedMemorialId}`;
      window.location.href = url;
    }



  </script>

  


</body>
</html>